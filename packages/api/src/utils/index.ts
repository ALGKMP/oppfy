/* eslint-disable no-debugger */
import { CloudFront } from "@oppfy/cloudfront";
import { Mux } from "@oppfy/mux";

import type { Post, Profile } from "../models";

const mux = new Mux();
const cloudfront = new CloudFront();

export type Hydrate<T> = T extends Profile
  ? T & { profilePictureUrl: string | null }
  : T extends Post
    ? T & { assetUrl: string }
    : never;

export const hydrateProfile = <T extends Profile>(
  profile: T,
): T & { profilePictureUrl: string | null } => {
  const profilePictureUrl = profile.profilePictureKey
    ? cloudfront.getProfilePictureUrl(profile.profilePictureKey)
    : null;

  return {
    ...profile,
    profilePictureUrl,
  };
};

export const hydratePost = async <T extends Post>(
  post: T,
): Promise<T & { assetUrl: string }> => {
  const assetUrl =
    post.mediaType === "image"
      ? await cloudfront.getSignedPrivatePostUrl(post.postKey)
      : mux.getStreamUrl(post.postKey);

  return { ...post, assetUrl };
};

export const shouldNeverHappen = (msg?: string, ...args: unknown[]) => {
  if (process.env.NODE_ENV === "development") {
    debugger;
  }

  throw new Error(
    `shouldNeverHappen: ${msg ?? "unknown error"} ${JSON.stringify(args)}`,
  );
};

export const invariant: <T>(
  predicate: T,
  msg?: string,
) => asserts predicate is NonNullable<T> = (predicate, msg) => {
  if (predicate) return;
  throw new Error(`Invariant failed: ${msg}`);
};

export const getRandomEmoji = (): string => {
  const emojis = [
    // Smileys & Emotion
    "ğŸ˜€",
    "ğŸ˜ƒ",
    "ğŸ˜„",
    "ğŸ˜",
    "ğŸ˜†",
    "ğŸ˜…",
    "ğŸ˜‚",
    "ğŸ¤£",
    "ğŸ˜Š",
    "ğŸ˜‡",
    "ğŸ™‚",
    "ğŸ™ƒ",
    "ğŸ˜‰",
    "ğŸ˜Œ",
    "ğŸ˜",
    "ğŸ¥°",
    "ğŸ˜˜",
    "ğŸ˜—",
    "ğŸ˜™",
    "ğŸ˜š",
    "ğŸ˜‹",
    "ğŸ˜›",
    "ğŸ˜",
    "ğŸ˜œ",
    "ğŸ¤ª",
    "ğŸ¤¨",
    "ğŸ§",
    "ğŸ¤“",
    "ğŸ˜",
    "ğŸ¤©",
    "ğŸ¥³",
    "ğŸ˜",
    "ğŸ˜’",
    "ğŸ˜",
    "ğŸ˜”",
    "ğŸ˜Ÿ",
    "ğŸ˜•",
    "ğŸ™",
    "â˜¹ï¸",
    "ğŸ˜£",
    "ğŸ˜–",
    "ğŸ˜«",
    "ğŸ˜©",
    "ğŸ¥º",
    "ğŸ˜¢",
    "ğŸ˜­",
    "ğŸ˜¤",
    "ğŸ˜ ",
    "ğŸ˜¡",
    "ğŸ¤¬",
    "ğŸ¤¯",
    "ğŸ˜³",
    "ğŸ¥µ",
    "ğŸ¥¶",
    "ğŸ˜±",
    "ğŸ˜¨",
    "ğŸ˜°",
    "ğŸ˜¥",
    "ğŸ˜“",
    "ğŸ¤—",
    "ğŸ¤”",
    "ğŸ¤­",
    "ğŸ¤«",
    "ğŸ¤¥",
    "ğŸ˜¶",
    "ğŸ˜",
    "ğŸ˜‘",
    "ğŸ˜¬",
    "ğŸ™„",
    "ğŸ˜¯",
    "ğŸ˜¦",
    "ğŸ˜§",
    "ğŸ˜®",
    "ğŸ˜²",
    "ğŸ¥±",
    "ğŸ˜´",
    "ğŸ¤¤",
    "ğŸ˜ª",
    "ğŸ˜µ",
    "ğŸ¤",
    "ğŸ¥´",
    "ğŸ¤¢",
    "ğŸ¤®",
    "ğŸ¤§",
    "ğŸ˜·",
    "ğŸ¤’",
    "ğŸ¤•",
    "ğŸ¤‘",
    "ğŸ¤ ",
    "ğŸ˜ˆ",
    "ğŸ‘¿",
    "ğŸ‘¹",
    "ğŸ‘º",
    "ğŸ¤¡",
    "ğŸ’©",
    "ğŸ‘»",
    "ğŸ’€",
    "â˜ ï¸",
    "ğŸ‘½",
    "ğŸ‘¾",
    "ğŸ¤–",
    "ğŸƒ",
    "ğŸ˜º",
    "ğŸ˜¸",
    "ğŸ˜¹",
    "ğŸ˜»",
    "ğŸ˜¼",
    "ğŸ˜½",
    "ğŸ™€",
    "ğŸ˜¿",
    "ğŸ˜¾",

    // Animals & Nature
    "ğŸ¶",
    "ğŸ±",
    "ğŸ­",
    "ğŸ¹",
    "ğŸ°",
    "ğŸ¦Š",
    "ğŸ»",
    "ğŸ¼",
    "ğŸ¨",
    "ğŸ¯",
    "ğŸ¦",
    "ğŸ®",
    "ğŸ·",
    "ğŸ½",
    "ğŸ¸",
    "ğŸµ",
    "ğŸ™ˆ",
    "ğŸ™‰",
    "ğŸ™Š",
    "ğŸ’",
    "ğŸ”",
    "ğŸ§",
    "ğŸ¦",
    "ğŸ¤",
    "ğŸ£",
    "ğŸ¥",
    "ğŸ¦†",
    "ğŸ¦…",
    "ğŸ¦‰",
    "ğŸ¦‡",
    "ğŸº",
    "ğŸ—",
    "ğŸ´",
    "ğŸ¦„",
    "ğŸ",
    "ğŸ›",
    "ğŸ¦‹",
    "ğŸŒ",
    "ğŸ",
    "ğŸœ",
    "ğŸ¦Ÿ",
    "ğŸ¦—",
    "ğŸ•·ï¸",
    "ğŸ•¸ï¸",
    "ğŸ¦‚",
    "ğŸ¢",
    "ğŸ",
    "ğŸ¦",
    "ğŸ¦–",
    "ğŸ¦•",
    "ğŸ™",
    "ğŸ¦‘",
    "ğŸ¦",
    "ğŸ¦",
    "ğŸ¦€",
    "ğŸ¡",
    "ğŸ ",
    "ğŸŸ",
    "ğŸ¬",
    "ğŸ³",
    "ğŸ‹",
    "ğŸ¦ˆ",
    "ğŸŠ",
    "ğŸ…",
    "ğŸ†",
    "ğŸ¦“",
    "ğŸ¦",
    "ğŸ¦§",
    "ğŸ˜",
    "ğŸ¦›",
    "ğŸ¦",
    "ğŸª",
    "ğŸ«",
    "ğŸ¦’",
    "ğŸ¦˜",
    "ğŸƒ",
    "ğŸ‚",
    "ğŸ„",
    "ğŸ",
    "ğŸ–",
    "ğŸ",
    "ğŸ‘",
    "ğŸ¦™",
    "ğŸ",
    "ğŸ¦Œ",
    "ğŸ•",
    "ğŸ©",
    "ğŸ¦®",
    "ğŸ•â€ğŸ¦º",
    "ğŸˆ",
    "ğŸˆâ€â¬›",
    "ğŸ¦",
    "ğŸ¦¨",
    "ğŸ¦¡",
    "ğŸ¦¦",
    "ğŸ¦¥",
    "ğŸ",
    "ğŸ€",
    "ğŸ¿ï¸",
    "ğŸ¦”",

    // Nature & Weather
    "ğŸŒŸ",
    "â­",
    "ğŸ’«",
    "âœ¨",
    "â˜€ï¸",
    "ğŸŒ™",
    "ğŸŒˆ",
    "â˜ï¸",
    "â›…",
    "ğŸŒ¤ï¸",
    "â›ˆï¸",
    "ğŸŒ©ï¸",
    "ğŸŒ¨ï¸",
    "â„ï¸",
    "â˜ƒï¸",
    "â›„",
    "ğŸŒŠ",
    "ğŸ’§",
    "â˜”",
    "âš¡",
    "ğŸ”¥",
    "ğŸ’¥",
    "ğŸŒ¡ï¸",
    "ğŸŒ",
    "ğŸŒ",
    "ğŸŒ",
    "ğŸª",
    "â˜„ï¸",
    "ğŸŒ‹",
    "ğŸ”ï¸",
    "â›°ï¸",
    "ğŸ—»",
    "ğŸ•ï¸",
    "ğŸ–ï¸",
    "ğŸœï¸",
    "ğŸï¸",
    "ğŸŒ³",
    "ğŸŒ²",
    "ğŸŒ´",
    "ğŸŒ±",
    "ğŸŒ¿",
    "â˜˜ï¸",
    "ğŸ€",
    "ğŸ",
    "ğŸ‹",
    "ğŸƒ",
    "ğŸ‚",
    "ğŸ",
    "ğŸŒ¾",
    "ğŸŒº",
    "ğŸŒ»",
    "ğŸŒ·",
    "ğŸŒ¹",
    "ğŸ¥€",
    "ğŸŒ¸",
    "ğŸ’",
    "ğŸŒ¼",
    "ğŸŒµ",
    "ğŸµï¸",
    "ğŸ’®",
    "ğŸª´",
    "ğŸª³",

    // Food & Drink
    "ğŸ",
    "ğŸŠ",
    "ğŸ‹",
    "ğŸŒ",
    "ğŸ‰",
    "ğŸ‡",
    "ğŸ“",
    "ğŸ«",
    "ğŸˆ",
    "ğŸ’",
    "ğŸ¥",
    "ğŸ‘",
    "ğŸ¥­",
    "ğŸ",
    "ğŸ¥¥",
    "ğŸ¥‘",
    "ğŸ…",
    "ğŸ†",
    "ğŸ¥’",
    "ğŸ¥¬",
    "ğŸŒ¶ï¸",
    "ğŸ«‘",
    "ğŸŒ½",
    "ğŸ¥•",
    "ğŸ«’",
    "ğŸ§„",
    "ğŸ§…",
    "ğŸ¥”",
    "ğŸ ",
    "ğŸ¥",
    "ğŸ¥¯",
    "ğŸ",
    "ğŸ¥–",
    "ğŸ¥¨",
    "ğŸ§€",
    "ğŸ¥š",
    "ğŸ³",
    "ğŸ§ˆ",
    "ğŸ¥",
    "ğŸ§‡",
    "ğŸ¥“",
    "ğŸ¥©",
    "ğŸ—",
    "ğŸ–",
    "ğŸ¦´",
    "ğŸŒ­",
    "ğŸ”",
    "ğŸŸ",
    "ğŸ•",
    "ğŸ¥ª",
    "ğŸ¥™",
    "ğŸ§†",
    "ğŸŒ®",
    "ğŸŒ¯",
    "ğŸ«”",
    "ğŸ¥—",
    "ğŸ¥˜",
    "ğŸ«•",
    "ğŸ¥«",
    "ğŸ",
    "ğŸœ",
    "ğŸ²",
    "ğŸ›",
    "ğŸ£",
    "ğŸ±",
    "ğŸ¥Ÿ",
    "ğŸ¦ª",
    "ğŸ¤",
    "ğŸ™",
    "ğŸš",
    "ğŸ˜",
    "ğŸ¥",
    "ğŸ¥ ",
    "ğŸ¥®",
    "ğŸ¢",
    "ğŸ¡",
    "ğŸ§",
    "ğŸ¨",
    "ğŸ¦",
    "ğŸ¥§",
    "ğŸ§",
    "ğŸ‚",
    "ğŸ°",
    "ğŸ®",
    "ğŸ­",
    "ğŸ¬",
    "ğŸ«",
    "ğŸ¿",
    "ğŸ©",
    "ğŸª",
    "ğŸŒ°",
    "ğŸ¥œ",
    "ğŸ¯",
    "ğŸ¥›",
    "ğŸ¼",
    "â˜•",
    "ğŸ«–",
    "ğŸµ",
    "ğŸ§ƒ",
    "ğŸ¥¤",
    "ğŸ§‹",
    "ğŸ¶",
    "ğŸº",
    "ğŸ»",
    "ğŸ¥‚",
    "ğŸ·",
    "ğŸ¥ƒ",
    "ğŸ¸",
    "ğŸ¹",
    "ğŸ§‰",
    "ğŸ¾",

    // Sports & Activities
    "âš½",
    "ğŸ€",
    "ğŸˆ",
    "âš¾",
    "ğŸ¥",
    "ğŸ¾",
    "ğŸ",
    "ğŸ‰",
    "ğŸ¥",
    "ğŸ±",
    "ğŸª€",
    "ğŸ“",
    "ğŸ¸",
    "ğŸ’",
    "ğŸ‘",
    "ğŸ¥",
    "ğŸ",
    "ğŸªƒ",
    "ğŸ¥…",
    "â›³",
    "ğŸª",
    "ğŸ¹",
    "ğŸ£",
    "ğŸ¤¿",
    "ğŸ¥Š",
    "ğŸ¥‹",
    "ğŸ½",
    "ğŸ›¹",
    "ğŸ›¼",
    "ğŸ›·",
    "â›¸ï¸",
    "ğŸ¥Œ",
    "ğŸ¿",
    "â›·ï¸",
    "ğŸ‚",
    "ğŸª‚",
    "ğŸ‹ï¸",
    "ğŸ¤¼",
    "ğŸ¤¸",
    "â›¹ï¸",
    "ğŸ¤º",
    "ğŸ‡",
    "ğŸ§˜",
    "ğŸ„",
    "ğŸŠ",
    "ğŸ¤½",
    "ğŸš£",
    "ğŸ§—",
    "ğŸšµ",
    "ğŸš´",
    "ğŸ†",
    "ğŸ¥‡",
    "ğŸ¥ˆ",
    "ğŸ¥‰",
    "ğŸ…",
    "ğŸ–ï¸",
    "ğŸµï¸",
    "ğŸ—ï¸",
    "ğŸ«",
    "ğŸŸï¸",

    // Hearts & Symbols
    "â¤ï¸",
    "ğŸ§¡",
    "ğŸ’›",
    "ğŸ’š",
    "ğŸ’™",
    "ğŸ’œ",
    "ğŸ–¤",
    "ğŸ¤",
    "ğŸ¤",
    "ğŸ’”",
    "â£ï¸",
    "ğŸ’•",
    "ğŸ’",
    "ğŸ’“",
    "ğŸ’—",
    "ğŸ’–",
    "ğŸ’˜",
    "ğŸ’",
    "ğŸ”¥",
    "ğŸ’¯",
    "ğŸ’¢",
    "ğŸ’¨",
    "ğŸ’¦",
    "ğŸ’¤",
  ] as const;

  const randomIndex = Math.floor(Math.random() * emojis.length);
  return emojis[randomIndex] ?? "ğŸ˜€";
};
