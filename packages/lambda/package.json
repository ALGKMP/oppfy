{
  "name": "@acme/lambda",
  "version": "0.1.0",
  "main": "./index.ts",
  "types": "./index.ts",
  "license": "MIT",
  "scripts": {
    "clean": "rm -rf .turbo node_modules",
    "lint": "eslint .",
    "lint:fix": "pnpm lint --fix",
    "type-check": "tsc --noEmit",
    "build": "esbuild index.ts --bundle --minify --sourcemap --platform=node --target=es2020 --outfile=dist/index.js",

    "docker:build": "docker build --platform linux/amd64 -t docker-image:test .",
    "aws:login-ecr": "aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 924061656603.dkr.ecr.us-east-1.amazonaws.com",
    "aws:create-ecr": "aws ecr create-repository --repository-name on-media-upload --region us-east-1 --image-scanning-configuration scanOnPush=true --image-tag-mutability MUTABLE",

    "docker:deploy-to-ecr": "docker tag docker-image:test 924061656603.dkr.ecr.us-east-1.amazonaws.com/on-media-upload:latest",
    "docker:push": "docker push 924061656603.dkr.ecr.us-east-1.amazonaws.com/on-media-upload:latest",

    "lambda:create-function": "aws lambda create-function --function-name on-media-upload --package-type Image --code ImageUri=924061656603.dkr.ecr.us-east-1.amazonaws.com/on-media-upload:latest --role arn:aws:iam::924061656603:role/lambda-ex",
    "lambda:update-function": "aws lambda update-function-code --function-name on-media-upload --image-uri 924061656603.dkr.ecr.us-east-1.amazonaws.com/on-media-upload:latest",

    "lambda:shit": "pnpm docker:build && pnpm aws:login-ecr && pnpm docker:deploy-to-ecr && pnpm docker:push",
    "lambda:create": " lambda:shit && pnpm lambda:create-function",
    "lambda:update": "lambda:shit && pnpm lambda:update-function"
  },
  "devDependencies": {
    "@types/aws-lambda": "^8.10.128",
    "esbuild": "^0.19.7",
    "eslint": "^8.45.0",
    "typescript": "^5.1.6"
  }
}